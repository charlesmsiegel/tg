<div class="row">
    <h2 class="col-sm {{ object.get_heading }}">Freebie Spend</h2>
</div>
{% if object.freebies > 0 %}
    <div class="row">
        <div class="col-sm">Spend Freebie points. The costs are as follows:</div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">
            <b>Trait</b>
        </div>
        <div class="col-sm-3 border">
            <b>Cost</b>
        </div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Attribute</div>
        <div class="col-sm-3 border">5</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Ability</div>
        <div class="col-sm-3 border">2</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Background</div>
        <div class="col-sm-3 border">1</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Willpower</div>
        <div class="col-sm-3 border">2</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Merits/Flaws</div>
        <div class="col-sm-3 border">Rating</div>
        <div class="col-sm-3"></div>
    </div>
    {% if object.companion_type == "familiar" %}
        <div class="row centertext">
            <div class="col-sm-3"></div>
            <div class="col-sm-3 border">Essence</div>
            <div class="col-sm-3 border">1</div>
            <div class="col-sm-3"></div>
        </div>
        <div class="row centertext">
            <div class="col-sm-3"></div>
            <div class="col-sm-3 border">Charms</div>
            <div class="col-sm-3 border">Essence Cost or 5</div>
            <div class="col-sm-3"></div>
        </div>
    {% endif %}
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Advantage</div>
        <div class="col-sm-3 border">Rating</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row">
        <h3 class="col-sm {{ object.get_heading }}">Freebies Remaining</h3>
        <h3 class="col-sm {{ object.get_heading }}">{{ object.freebies }}</h3>
    </div>
{% endif %}
<div class="row">
    <div class="col-sm">{{ form.category }}</div>
    <div class="col-sm d-none" id="example_wrap">{{ form.example }}</div>
    <div class="col-sm d-none" id="value_wrap">{{ form.value }}</div>
    <div class="col-sm d-none" id="note_wrap">{{ form.note }}</div>
</div>
{% for item in object.spent_freebies %}
    <div class="row">
        <div class="col-sm">{{ item.trait }} {{ item.value }}</div>
        <div class="col-sm">{{ item.cost }} freebies</div>
    </div>
{% endfor %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const categorySelectMenu = document.getElementById("id_category");
        const exampleElement = document.getElementById("example_wrap");
        const valueElement = document.getElementById("value_wrap");
        const noteElement = document.getElementById("note_wrap");

        function updateVisibility() {
            const value = categorySelectMenu.value;

            // Reset all to hidden
            exampleElement.classList.add("d-none");
            valueElement.classList.add("d-none");
            noteElement.classList.add("d-none");

            // Show fields based on category
            if (!["Willpower", "-----"].includes(value)) {
                exampleElement.classList.remove("d-none");
            }

            if (value === "MeritFlaw" || value === "Advantage") {
                valueElement.classList.remove("d-none");
            }

            if (value === "Background") {
                noteElement.classList.remove("d-none");
            }
        }

        categorySelectMenu.addEventListener("change", updateVisibility);

        // Initial visibility on page load
        updateVisibility();
    });
</script>
