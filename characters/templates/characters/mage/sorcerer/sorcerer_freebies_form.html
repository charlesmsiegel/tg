<div class="row">
    <h2 class="col-sm {{ object.get_heading }}">Freebie Spend</h2>
</div>
{% if object.freebies > 0 %}
    <div class="row">
        <div class="col-sm">Spend Freebie points. The costs are as follows:</div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">
            <b>Trait</b>
        </div>
        <div class="col-sm-3 border">
            <b>Cost</b>
        </div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Attribute</div>
        <div class="col-sm-3 border">5</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Ability</div>
        <div class="col-sm-3 border">2</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Background</div>
        <div class="col-sm-3 border">1</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Willpower</div>
        <div class="col-sm-3 border">2</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Merits/Flaws</div>
        <div class="col-sm-3 border">Rating</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Paths</div>
        <div class="col-sm-3 border">7</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row centertext">
        <div class="col-sm-3"></div>
        <div class="col-sm-3 border">Rituals</div>
        <div class="col-sm-3 border">3</div>
        <div class="col-sm-3"></div>
    </div>
    <div class="row">
        <h3 class="col-sm {{ object.get_heading }}">Freebies Remaining</h3>
        <h3 class="col-sm {{ object.get_heading }}">{{ object.freebies }}</h3>
    </div>
{% endif %}
<div class="row">
    <div class="col-sm">{{ form.category }}</div>
    <div class="col-sm d-none" id="example_wrap">{{ form.example }}</div>
    <div class="col-sm d-none" id="value_wrap">{{ form.value }}</div>
    <div class="col-sm d-none" id="note_wrap">{{ form.note }}</div>
    <div class="col-sm d-none" id="practice_wrap">{{ form.practice }}</div>
    <div class="col-sm d-none" id="ability_wrap">{{ form.ability }}</div>
</div>
<div id="id_create_ritual_form" class="d-none">
    <div class="row">
        <div class="col-sm">{{ ritual_form.name }}</div>
    </div>
    <div class="row">
        <div class="col-sm">{{ ritual_form.path }}</div>
        <div class="col-sm">{{ ritual_form.level }}</div>
    </div>
    <div class="row">
        <div class="col-sm">{{ ritual_form.description }}</div>
    </div>
</div>
{% for item in object.spent_freebies %}
    <div class="row">
        <div class="col-sm">{{ item.trait }} {{ item.value }}</div>
        <div class="col-sm">{{ item.cost }} freebies</div>
    </div>
{% endfor %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const categorySelectMenu = document.getElementById("id_category");
        const exampleElement = document.getElementById("example_wrap");
        const valueElement = document.getElementById("value_wrap");
        const noteElement = document.getElementById("note_wrap");
        const practiceElement = document.getElementById("practice_wrap");
        const abilityElement = document.getElementById("ability_wrap");
        const createritualformElement = document.getElementById("id_create_ritual_form");

        function updateVisibility() {
            const value = categorySelectMenu.value;

            // Reset all to hidden
            exampleElement.classList.add("d-none");
            valueElement.classList.add("d-none");
            noteElement.classList.add("d-none");
            practiceElement.classList.add("d-none");
            abilityElement.classList.add("d-none");
            createritualformElement.classList.add("d-none");

            // Show fields based on category
            if (!["Willpower", "-----", "Create Ritual"].includes(value)) {
                exampleElement.classList.remove("d-none");
            }

            if (value === "MeritFlaw" || value === "Advantage") {
                valueElement.classList.remove("d-none");
            }

            if (value === "Background") {
                noteElement.classList.remove("d-none");
            }

            if (value === "New Path" && "{{object.sorcerer_type}}" === "hedge_mage") {
                practiceElement.classList.remove("d-none");
                abilityElement.classList.remove("d-none");
            }

            if (value === "Create Ritual") {
                createritualformElement.classList.remove("d-none");
            }
        }

        categorySelectMenu.addEventListener("change", updateVisibility);

        // Initial visibility on page load
        updateVisibility();
    });
</script>
